<!-- WIP Banner -->
<div class="wip-banner">
  <span class="icon">ğŸš§</span>
  <span>WORK IN PROGRESS - Using ArgentGrid Component</span>
  <a href="https://github.com/HainanZhao/ArgentGrid" target="_blank">View on GitHub â†’</a>
</div>

<div class="demo-container">
  <header class="demo-header">
    <div>
      <h1>ğŸ¨ ArgentGrid - Canvas-Based Grid</h1>
      <p>Ultra-High Performance - 1,000,000+ Rows at 60fps</p>
      <div class="feature-list">
        <span class="feature highlight">âœ“ Canvas Rendering</span>
        <span class="feature highlight">âœ“ Zero DOM Overhead</span>
        <span class="feature highlight">âœ“ GPU Accelerated</span>
        <span class="feature">âœ“ AG Grid Compatible</span>
        <span class="feature">âœ“ < 50KB Bundle</span>
      </div>
    </div>
    <div class="demo-stats">
      <div class="stat-badge">
        <strong>{{ rowCount | number }}</strong> rows
      </div>
      <div class="stat-badge">
        <strong>{{ renderTime }}</strong>ms load
      </div>
      <div class="stat-badge" title="Time taken by canvas to render the last frame">
        <strong>{{ canvasFrameTime }}</strong>ms frame
      </div>
      <div class="stat-badge">
        <strong>{{ fps }}</strong> FPS
      </div>
      <button class="btn btn-benchmark" (click)="runBenchmark()" [disabled]="isLoading || isBenchmarking">
        {{ isBenchmarking ? 'Running...' : 'ğŸš€ Benchmark' }}
      </button>
      <button class="btn" (click)="loadData(100000)" [disabled]="isLoading || isBenchmarking">
        {{ isLoading ? 'Loading...' : '100K' }}
      </button>
      <button class="btn" (click)="loadData(500000)" [disabled]="isLoading">
        {{ isLoading ? 'Loading...' : '500K' }}
      </button>
      <button class="btn" (click)="loadData(1000000)" [disabled]="isLoading">
        {{ isLoading ? 'Loading...' : '1M' }}
      </button>
    </div>
    <div class="demo-controls">
      <button class="btn btn-secondary" (click)="saveState()" title="Save grid state to LocalStorage">
        ğŸ’¾ Save State
      </button>
      <button class="btn btn-secondary" (click)="restoreState()" [disabled]="!hasState()" title="Restore grid state from LocalStorage">
        ğŸ“¥ Restore State
      </button>
      <button class="btn btn-secondary" (click)="clearState()" [disabled]="!hasState()" title="Clear saved state">
        ğŸ—‘ï¸ Clear State
      </button>
      <button class="btn btn-secondary" (click)="toggleGrouping()">
        {{ isGrouped ? 'Ungroup' : 'Group by Dept' }}
      </button>
      <button class="btn btn-secondary" (click)="toggleMasterDetail()">
        {{ isMasterDetail ? 'Disable Detail' : 'Master/Detail' }}
      </button>
      <button class="btn btn-secondary" (click)="togglePivotMode()">
        {{ isPivotMode ? 'Disable Pivot' : 'Pivot Mode' }}
      </button>
      <button class="btn btn-secondary" (click)="toggleSideBar()">
        {{ isSideBarVisible ? 'Hide Sidebar' : 'Show Sidebar' }}
      </button>
      <button class="btn btn-secondary" (click)="toggleFloatingFilter()">
        {{ isFloatingFilterShown ? 'Hide Filters' : 'Show Filters' }}
      </button>
      <button class="btn btn-secondary" (click)="toggleFilter()">
        {{ isFiltered ? 'Clear Filter' : 'Filter "Eng"' }}
      </button>
    </div>
  </header>

  @if (benchmarkResults) {
    <div class="benchmark-results">
      <h3>ğŸš€ Benchmark Results ({{ rowCount | number }} rows)</h3>
      <div class="results-grid">
        <div class="result-item">
          <label>Initial Render:</label>
          <span>{{ benchmarkResults.initialRender.toFixed(2) }}ms</span>
        </div>
        <div class="result-item">
          <label>Avg Scroll Frame:</label>
          <span>{{ benchmarkResults.scrollFrameAverage.toFixed(2) }}ms</span>
        </div>
        <div class="result-item">
          <label>Selection All:</label>
          <span>{{ benchmarkResults.selectionUpdateTime.toFixed(2) }}ms</span>
        </div>
        <div class="result-item">
          <label>Grouping Toggle:</label>
          <span>{{ benchmarkResults.groupingUpdateTime.toFixed(2) }}ms</span>
        </div>
        <div class="result-item">
          <label>Total Test Time:</label>
          <span>{{ benchmarkResults.totalTime.toFixed(2) }}ms</span>
        </div>
      </div>
      <button class="btn btn-small" (click)="benchmarkResults = null">Close</button>
    </div>
  }

  <div class="grid-wrapper">
    @if (isLoading) {
      <div class="loading">
        <div class="loading-spinner"></div>
        <p>Loading {{ rowCount | number }} rows...</p>
      </div>
    } @else {
      <argent-grid
        [columnDefs]="columnDefs"
        [rowData]="rowData"
        [gridOptions]="gridOptions"
        [rowHeight]="32"
        [height]="'100%'"
        [width]="'100%'"
        (gridReady)="onGridReady($event)"
        (rowClicked)="onRowClicked($event)"
      />
    }
  </div>

  <div class="footer">
    <span>Built with Angular 18 + Canvas 2D API</span>
    <span>
      <a href="https://github.com/HainanZhao/ArgentGrid" target="_blank">View on GitHub â†’</a>
    </span>
  </div>
</div>
